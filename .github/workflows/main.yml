on: 
  push:
    branches:
      - nextjs-mongodb
name: üöÄ Deploy website on push
jobs:
  deploy:
    name: üéâ Deploy
    runs-on: ubuntu-latest
    steps:
      - name: üöö Get latest code (with LFS)
        uses: actions/checkout@v4
        with:
          lfs: true

      - name: üß∞ Install dependencies
        run: npm install

      - name: üèóÔ∏è Build Next.js app
        run: npm run build
        env:
          NEXT_PUBLIC_API_BASE_URL: "https://sample.southernleyte.org.ph/"
          NEXTAUTH_ACCESSTOKEN: "sample-token"
          MONGODB_URI: "mongodb+srv://cdynjm:xxSn3JXb0CkbN5BS@cluster1.ziep46f.mongodb.net/myappdb?retryWrites=true&w=majority&appName=Cluster1"
          NEXTAUTH_SECRET: "sample-secret"
          NEXTAUTH_URL: "https://sample.southernleyte.org.ph/"
          CRYPTO_SECRET_KEY: "egikeriokergerigrtjhbtrbobj"
          BLOB_READ_WRITE_TOKEN: "vercel_blob_rw_UaktdAnRLs0DysAl_BdQ8fNtuXe1wcCO7zqrDXIW3MNvGSb"
          JWT_SECRET: "2vBveAMr8V2W7sB3rgZBwQxdIs77zSZzkhv0ltV5dQJAHwehwX"

      - name: üöÄ Upload .next folder to cPanel via FTP
        run: node scripts/deploy.js
        env:
          server: ${{ secrets.SERVER }}
          username: ${{ secrets.USERNAME }}
          password: ${{ secrets.PASSWORD }}
